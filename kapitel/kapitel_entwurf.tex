\chapter{Entwurf}
\section{Wahl der Spieleumgebung}
\subsection{Wahl der Programiersprache}
--> C++ 3D 
--> C++ Audio
--> Alternativen?


\section{Conferencing vs. Ingame Communication}
Problems related to conference control have been studied extensively over the years. 
Literature from "`A SIP-Based Conference Control Framework"'. However most of the earlier work discusses only the floor control aspects of conference control. Furthermore some papers focus on multicast conferences. In the absence of a widely available internet multicast service we will focus on the corrently more common ....


\section{Kommunikationsaspekte}
\subsection{Sprache vs. Nonverbal vs. Text}
\subssection{Proximität}
\subsection{Interpersonelle vs. Massenkommunikation}
\subsection{...}
THE WHY: Work of Kevin Hew, Martin Gibbs, Greg Wadley
	\cite{gibbs06}
	\cite{Gibbs04a}
	\cite{gibbs04}


\section{Wahl des VoiP Standards}
My focus:
Audio management that restricts the use of the audio channel, including explicit and implicit floor control , and control actions like push to talk. 

\subsection{Skype}
\subsection{SIP}
	\cite{schulzrinne05} -- Peer-to-Peer SIP Assumptions
	
\subsubsection{PJSIP}
\subsubsection{WengoPhone}
\subsubsection{others}


\section{Wahl der Netzwerk Architektur}
\subsection {Analyse der bestehenden Architekturen für Audioübertragung}

In einer Studie vergleichen Safei und Boustead Architekturen für sinnstimulierende (immersive) Audio Kommunikation in Mehrspieler Netzwerk Spielen. Dabei ist unter sinnstimuliernd zu verstehen dass jeder Spieler eine eine Mischung aus Stimmen und Geräuschen hören soll die speziell auf seine Position im Spiel angepasst ist und nicht nur die Lautstärke als auch die Position der Geräusche im Klangbild spezifiziert wird. 

In einer Peer-to peer Architektur wird die Audioszene lokal erzeugt, nachdem man sämtliche Sprachquellen der der anderen Spieler erhalten hat. Der Hauptvorteil dieser Architektur liegt darin dass ein niedriger Delay auftritt, da die im optimalen Fall die Verbindung immer die kürzesten Wege zwischen den einzelnen Spielern etabliert wird. Zusätzlich nutzt man die freie Rechenleistung in den Knoten um das Abmischen der Audioszene vorzunehmen und man verfügt potenziell über eine Architektur die keinen single Point of Failure besitzt.  Der Hauptnachteil ist dass die Bandbreite der einzelnen Knoten im Peer-to-Peer die Anzahl der möglichen Verbindungen limitiert. 
%BILD


In einer Zentralisierten Lösungen wird der Audiostrom von jedem der Teilnehmer an einen zentralen Server gesendet. Mithilfe der Positionsdaten der Spieler wird die Audioszene zentral erzeugt. Diese wird danach an die jeweiligen Spieler gesendet. Die Hauptvorteile sind eine bessere Skalierbarkeit dadurch dass jeder Knoten auch mit beschränkter Bandbreite in der Lage ist teilzuhemen. Der Nachteil jedoch beim einsatz eines Zentralen servers ist dass für die Teilnehmer große Delays auftreten können wenn sie physikalisch weit vom Server entfernt sind. Zusätzlich ist die Kapazität des zentralen Servers Flaschenhals die sich im Grad von $O(N^2)$ erschöpft ein Flaschenhals. 
% BILD

In einer Proxy Lösung exitieren Server die sich weltweit verteilt immer eine geringe Entfernung zum Teilnehmer ermöglichen sollen. Diese Emfpangen die Audioströme, mischen diese ab und schicken sie zuürck an die jeweiligen Spieler. Die Proxys untereinader können ebenfalls Audioströme an weitere Proxys weiterleiten, falls diese benötigt werden. Im Gegensatz zur Peer-To-Peer Architektur können durch den Einsatz von dedizierten Proxys mit guter Anbindung Bandbreitenprobleme minimiert werden. Der Nachteil ist jedoch dass keine Korelation zur Position der Spieler in der Welt und den genutzten Proxys existiert, so dass nur Spieler die sich den gleichen Proxy benutzen und im Spiel ebenfalls Teil der gleichen Audioumgebung sind davon profitieren können. 

In einer verteilten Server Lösung ist jeder zentrale Server nur für einen Teil der Spielewelt verantwortlich. So nutzen Spieler die sich in der gleichen virtuellen Umgebung den gleichen Server, der Ihre Audiodaten abmischt. Dieser Ansatz kann die Auftretenden Bandbreite einer zentralisierten Lösung zwar reduzieren, in dem die Last auf mehrere Server verteilt wird, bringt aber neue Probleme beim Übergang von einem Server zum anderen: Wenn Teilnehmer während dem Spiel die Spielzone wechseln und die Audioszene nun von einem anderen Server abgemischt werden soll. 

Im Ansatz einer Hybrid Architektur senden die Teilnehmer ihre Audioströme zwar an einen zentralisierten Server, können aber bei Bedarf ihre Audioströme direkt austauschen, wenn die indirekte Route über den Server zu zu hohen Verzögerungen führen würde. 


Safei und Boustead führen in einer Vergleichenden Studien \cite{safei04} \cite{safei04b} den Begriff des Interaktiven Delays ein, und die Parameter der Korrelation zwischen der physischen und virtuellen Welt sowie der Dichte und Verteilung von Avataren ein. 

Als interaktiver Delay wird der mittlere Delay zwischen der Audioquelle und allen Zuhörern verstanden. 

	\[	
	\frac{\sum ^{N}_{i=1} d(m,n_{i})} {\sum ^{N}_{i=1} n_{i}}
\]

Die Korrelation zwischen der physischen und virtuellen Welt, zwischen 0 und 1, gibt an wie hoch die Wahrscheinlichkeit ist dass Spieler sowohl physikalisch als auch virtuell sich in der Nähe befinden. Eine Korrelation von 0 bedeutet dass die Avatare in der virtuellen Welt nicht mit der Lokation der Spieler in der physischen Welt korreliert ist. 

Die Dichte der Avatare gibt an wie viele Avatare sich in der Hörnähe des Spielers befinden. 

Die Verteilung der Avatare kann entweder uniform sein, bei der die Spieler zufällig gelichmäßig in der virtuellen Welt verteilt sind oder auch einzelne Ballungszentren besitzen. Dabei werden zuällig Ballungszentren verteilt und um diese mit hoher Dichte zum Ballungszentrum Avatare zuällig verteilt.

In Simulationen \cite{safei04} der oben genannten der Architekturen wurden der Einfluss der Parameter der Korrelation und Dichte auf das interaktive Delay und die Netzwerklast untersucht. Die Resultate der Simulation zeigten, das bei einem zentralisiertem Modell die Korrelation der Avatare keinen Einfluss auf den interaktiven Delay hatte. In einer verteilten Server Lösung war mit zunehmender Korelation eine Reduzierung des Delays erzielt worden. Die Peer-to-Peer Architektur dominierte alle anderen Lösungen mit dem geringsten Delay, der unabhängig von der Korrelation immer konstant klein verblieb. 
Die Zunehmende Dichte der Avatare bei zentralisierten Lösungen hatte keinen signifikanten Einfluss auf die Netzwerkalast. Bei Peer-to-Peer Architekturen stieg diese zwar zuerst exponentiell an, konvergierte jedoch schnell gegen einen Mittelwert, da nicht die Anzahl der Teilnehmer erhöht wurde sondern nur die Dichte. Die geringste Netzwerklast zeigte die verteilte Server Lösung wobei die Simulation die Dichte speziell in den entsprechenden Zonen erhöhte. 


\subsection{Client Server}
\subsubsection{Netmeeting}
\subsubsection{Ventrillo}
\subsubsection{Teamspeak}
\subsubsection{Battlecom}

\subsection{Reine Peer-to-Peer Modelle}
\subsection{Problems}

Client Server O(1) Lookup Latency vs. Chord O(logN) lookup!
Security Issues 


\subsection{Hybrid Model}

\subsubsection{Design alternatives}
\subsubsection[{Replicate registrations vs. search on call setup}
Durch die serverbasierte Architektur kann der server schnell ein Flaschenhals sowohl für die Bandbreite als auch für die Verfügbarkeit werden. Eine Möglichkeit ist der einsatz mehrerer Redundanter Server. Dabei bestehen zwei Alternativen.

\begin{itemize}
	\item Die Benutzer Lokationsinformations auf allen Servern zu replizieren.
	\item Die Suche nach dem korrekten Server der die Lokation des Benutzers enthält auf allen Servern auszuführen, während die Registrierung nur auf einem Server geschieht.
\end{itemize}

% BILD see \cite{schulzrinne05}

Im ersten Fall könnte durch Datenbanken Replikation Sichergestellt werden dass die Benutzereinträge zwischen verschiedenen Servern konsistent gehalten werden. Im zweiten Fall kann entweder der Benutzer alle Server kontaktieren oder der erste kontaktiere Server die Anfrage weiterleiten. 

Der Nachteil des ersten Ansatzes ist das eine Synchronisation für jede Registrierung erforderlich ist. Es besteht die Möglichkeit dass Einträge veraltet sind bevor eine Synchronisation zwischen den Servern ausgeführt wird. Mit einer wachsenden Anzahl and Benutzern könnte diese Architektur der zusätzliche Netzwerkverkehr zwischen den Servern zu einem Flaschenhals werden. 

Im Anderen Fall ist die Verbindungslatenz höher da erst eine Reihe von Schritten durchlaufen werden muss. Eine parallele Suche erhöht zudem die benötigte Bandbreite.  

Beide Ansätze können fehlschlagen wenn die Anzahl an Benutzern sehr groß wird.

%TODO Analysis of Ansatz 1
%\cite{schulzrinne07}


