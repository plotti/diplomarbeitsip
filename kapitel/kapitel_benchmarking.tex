\chapter{Evaluation}

\section{Fullmesh vs. Partialmesh Szenario}

Um zu verdeutlichen wie der umgesetzte Ansatz, zu Einsparungen beim Verbrauch der Bandbreite eingesetzt werden kann, wird er mit einem gewöhlichem Full-Mesh Ansatz verglichen. Im diesem baut jeder Teilnehmer des Spiels mit allen anderen 
Teilnehmern Audioverbindungen auf, unabhängig davon wo sich diese im Spiel befinden.

Im vorgeschlagenen Partial-Mesh Ansatz verbindet sich der Teilnehmer nur mit Spielern die sich in seiner unmittelbaren Nähe befinden. Dies entspricht dem in Kapitel 3 und 7 vorgestellten Proximitätskonzept, in dem nur Audioverbindungen mit Spielern aufgebaut werden, die sich mindestens in der Öffentlichen Zone befinden.

Um zu vergleichen, wie mit dem umgesetzten Ansatz Bandbreite eingespart werden kann, wurde ein Szenario entwickelt, in dem beide Ansätze ausprobiert werden: In diesem betreten 5 Spieler nacheinander die Spielewelt, wobei sich Spieler 1,2 und 3 in Hörnähe befinden, während Spieler 5 und 6 isolierte Positionen einnehmen.

\subsection{Full Mesh}
Die Abbildung \ref{fullmeshszenario} zeigt, dass beim Full-Mesh Ansatz jeder Teilnehmer Verbindungen zu allen anderen Teilnehmern etabliert hat. Die Nummer des Teilnehmers entspricht der Reihenfolge seiner Teilnahme am Spiel: Zunächst betritt Teilnehmer 1 das Spielfeld, danach Teilnehmer 2, usw... Jeder Teilnehmer baut beim Betreten der Spielewelt Verbindungen zu allen andern Spielern auf.

\begin{figure}[tbh]
	\centering
		\includegraphics[width=.60\textwidth]{grafiken/fullmesh.eps}
			\caption{Audioverbindungen im Full-Mesh Ansatz}
	\label{fig:fullmesh}
\end{figure}

Der Bandbreitenverbrauch wurde aus Sicht des Teilnehmers 1 gemessen. Da alle 10 Sekunden ein weiterer Spieler das Spielfeld betritt, wird auch entsprechend eine Audioverbindung mit diesem Spieler aufgebaut. Dies führt dazu, dass der Verbrauch der Bandbreite sich jeweils um weitere 10Kb/s erhöht. Bei allen Messungen wurde der Speex Codec mit einer Abtastrate von 16kHz benutzt, der eine mittlere Bitrate von 10 - 15 Kb/s besitzt.

\begin{figure}[tbh]
	\centering
		\includegraphics[width=.70\textwidth]{grafiken/fullmeshchart.eps}
	\caption{Bandbreitenverbrauch beim Full Mesh Ansatz}
	\label{fig:fullmesh-withchart}
\end{figure}

\subsection{Partial Mesh}
Im gleichen Szenario wurde nun die Partial-Mesh Technik eingesetzt, bei der nur noch Verbindungen mit Teilnehmern aufgebaut wurden, die sich mindestens in der öffentlichen Zone des Spielers befinden. 

In dieser Zone wird der ein SIP Anruf ausgeführt und eine \textit{Silence Supression} auf RTP Ebene durchgeführt, bis der Teilnehmer sich in die Soziale Zone begibt. In der sozialen Zone wird der volle RTP Audiostrom zwischen den Teilnehmern initiiert. 

Diese Technik führt dazu, dass im vorgestellten Szenario Spieler 1 zunächst zwei logische SIP Verbindungen mit Spieler 2 und 3 etabliert. Während mit Spieler 2 ein voller RTP Audiostrom fließt, wird mit Spieler 3 nur eine Audioverbindung mit \textit{Silence Suppression} etabliert. Teilnehmer 4 und 5 bauen keine Verbindungen auf da sie sich nicht in Hörreichweite befinden. 

\begin{figure}[tbh]
	\centering
		\includegraphics[width=.70\textwidth]{grafiken/partialmesh.eps}
	\caption{Ein Partial-Mesh der Audioverbindungen der Teilnehmer}
	\label{fig:partialmesh}
\end{figure}

Der  Bandbreitenverbrauch wurde hier auch aus Sicht des Teilnehmers 1 gemessen. Abbildung \ref\{fig:partialmeshchart} zeigt, dass in dem Moment in dem Spieler 2 das Spiel betritt, eine Audioverbindung aufgebaut wird, die zwischen 10-15kb/s verbraucht. Betritt Spieler 3 das Spiel, werden nur zusätzlich ca. 1-2kb/s zur Aufrechterhaltung der Grundkonnektivität der RTP Verbindung benötigt. Würde sich Teilnehmer 3 nun auf Spieler 1 zu bewegen, würde die Silence Suppression aufgehoben und auch ein normaler Audiostrom von 10-15kbs fließen. Spieler 4 und 5 verursachen keinen zusätzlichen Bandbreitenverbrauch, da sie sich außerhalb der öffentlichen Zone befinden.

\begin{figure}[tbh]
	\centering
		\includegraphics[width=.70\textwidth]{grafiken/partialmeshchart.eps}
	\caption{Bandbreiteneinsparungen beim Partial-Mesh, da nicht mehr alle Verbindungen aufgebaut werden müssen}
	\label{fig:partialmeshchart}
\end{figure}

\subsubsection{Partial-Mesh Worst Case}
Im Worst-Case Fall, befinden sich alle Avatare im gegenseitigen Hörradius, was dazu führt, dass auch ein Full-Mesh zwischen den Teilnehmern aufgebaut wird. Hier kann keine Bandbreite eingespart werden, und das vorgestellte Verfahren ist verliert seinen Vorteil.

\begin{figure}[tbh]
	\centering
		\includegraphics[width=0.70\textwidth]{grafiken/fullmesh-worstcase.eps}
	\caption{Partial-Mesh Worstcase Szenario gleicht dem Fullmesh Ansatz}
	\label{fig:fullmesh-worstcase}
\end{figure}

\section{Zonenkonzepte}
Um den Bandbreitenverbrauch in den einzelnen Zonen zu verdeutlichen, wurde ein einfaches Szenario erstellt, bei 2 Spieler am gleichen Ausgangspunkt starten und sich dann ein Spieler wegbewegt. Während er einzelnen Zonen durchläuft wurde sein Bandbreitenverbrauch gemessen. Dabei wurde nicht nur zwischen dem Up- und Downloadverbrauch sondern auch zwischen dem SIP und RTP Protokoll unterschieden. 
Die Messungen entsprechen den 3 vorgestellten Zonen Variationen, die bereits in Kapitel 7 erläutert wurden. 

\subsection{Ohne Unterscheidung}
Hier entfernen sich beide Spieler voneinander, es wird in der öffentlichen Zone jedoch keine Silence Supression, Änderung des Codecs oder "`Hold"' vorgenommen. Man kann an der Abbildung \ref{fig:NOVADrtpsip} erkennen, dass die Bandbreite sich in allen Zonen gleichmäßig verhält. 

\begin{figure}[tbh]
	\centering
	\label{ohnevadupdown}
	\caption{Der Up- und Downstream}
		\includegraphics[width=1.00\textwidth]{grafiken/ohnevpn1.eps}
	\label{fig:NOVADrtpsip}
\end{figure}

Beim Vergleich des RTP und SIP Protokolls in Abbildung \ref{fig:NoVADupdown} sieht man, dass SIP nur zum Signalisieren des Anrufs benutzt wird, da es nur am Anfang und Ende des SIP Anrufs Bandbreite erzeugt, während das RTP Protokoll für den reinen Audiostrom zuständig ist. 

\begin{figure}[tbh]
	\centering
		\includegraphics[width=1.00\textwidth]{grafiken/ohnevpn2.eps}
		\caption{Signalisierung mit SIP, Audiostrom mit RTP}
	\label{fig:NoVADupdown}
\end{figure}


\subsection{Zonen mit RTP Silence Supression}

Hier wird in der öffentlichen Zone eine Silence Supression durchgeführt. In der Abbildung \ref{fig:VADupdown} ist zu erkennen, dass der sich hier der Bandbreitenverbrauch auf unter 2kbps reduziert, während er in der privaten und sozialen Zone knapp das 6fache beträgt. 

\begin{figure}[tbh]
	\centering
		\includegraphics[width=1.00\textwidth]{grafiken/mitvadupdown.eps}
		\caption{Der Up- und Downstream mit der VAD - Technik}
	\label{fig:VADupdown}
\end{figure}

In der Abbildung \ref{fig:VADRTPSIP} wurden die SIP und RTP Protokolle dargestellt. Man kann erkennen, dass bei der Silence Supression beim RTP Protokoll die Bandbreite drastisch sinkt. Es wird auch deutlich, dass in diesem Fall nicht das SIP Protokoll eingesetzt wird, um diese Änderung zu bewirken, sondern es sich um eine Eigenschaft des RTP Protokolls handelt.

\begin{figure}[tbh]
	\centering
		\includegraphics[width=1.00\textwidth]{grafiken/mitvadrtpsip.eps}
		\caption{Gegenüberstellung der SIP und RTP Traffics mit der VAD - Technik}
	\label{fig:VADRTPSIP}
\end{figure}

\subsection{Zonen mit SIP HOLD}

Eine weitere Unterscheidung der Zonen wurde mit dem SIP "`Hold Call"' Ansatz versucht, bei dem in der öffentlichen Zone, mittels des SIP Protokolls der logische Anruf gehalten wird, aber auf RTP Ebene keine Übertragung der Pakete stattfindet.
Dieser Ansatz kann sogar noch mehr Bandbreite in der öffentlichen Zone einsparen, da praktisch kein Datenaustausch stattfindet. Allerdings konnte er sich in der Praxis nicht bewähren, da beim Halten und Wiederaufnehmen des Gesprächs, die Sitzungsparameter wieder neu verhandelt werden, was zu einer spürbaren Verzögerung geführt hatte. Es ist vorstellbar, dass der SIP Anruf schon etwas früher wiederaufgenommen wird, um diese Verzögerung auszugleichen. 

\begin{figure}[tbh]
	\centering
		\includegraphics[width=1.00\textwidth]{grafiken/mitholdupanddown.eps}
		\caption{Der Up- und Downstream mit der SIP HOLD - Technik}
	\label{fig:mitholdupanddown}
\end{figure}

Beim Bandbreitenvergleich der SIP und RTP Protokolle sieht man diesmal, dass beim Übergang in die öffentliche Zone eine Signalisierung mittels SIP stattfindet. 

\begin{figure}[tbh]
	\centering
	\caption{Gegenüberstellung des SIP und RTP Traffics mit der SIP HOLD - Technik}
		\includegraphics[width=1.00\textwidth]{grafiken/mithold1.eps}
	\label{fig:mithold1}
\end{figure}

\subsection{Zonen mit unterschiedlichen Audiocodecs}
Die dritte Variante beinhaltete den Einsatz von 2 verschiedenen Codecs für die Private und Soziale Zone. In der Privaten Zone wurde der qualitativ hohe Speex Codec mit einer Abtastrate von 16kHz verwendet, während in der sozialen Zone nur der Speex Codec mit einer Abtastrate von 8kHz verwendet wurde. 

Da erwartet wird, dass mehr Verbindungen in der Sozialen Zone als in der Privaten Zone aufgebaut werden, wird hier auch ein Codec mit einer niedrigeren Bitrate verwendet, um eine größere Anzahl an Verbindungen zu ermöglichen. In der Öffentlichen Zone wird wie bereits im oberen Beispiel die \textit{Silence Supression} angewendet. Unter diesen Voraussetzungen ist in Abbildung \ref{fig:mitvadund2codecs} zu sehen, dass der Bandbreitenverbrauch in der sozialen Zone im Vergleich zur privaten Zone reduziert wird und in der öffentlichen Zone sehr gering ausfällt.

\begin{figure}[tbh]
	\centering
		\includegraphics[width=\textwidth]{grafiken/mitvadund2codecs.eps}
		\caption{Speex mit 32kHz in der Privaten Zone und Speex 8khZ in der Sozialen Zone}
	\label{fig:mitvadund2codecs}
\end{figure}

Im Vergleich (siehe Abbildung \ref{fig:mitvadundrtpsip}) der beiden SIP und RTP Protokolle ist beim SIP Protokoll sowohl der Ruf -auf und -abbau zu erkennen als auch die Signalisierung eines anderen Sprachcodecs beim Übergang von der Privaten in die Soziale Zone. Beim RTP Protokoll ist die Übertragung des Audiostroms zu erkennen und die reduzierte Bitrate in der Sozialen und Öffentlichen Zone.

\begin{figure}[tbh]
	\centering
		\includegraphics[width=\textwidth]{grafiken/mitvadundrtpsip.eps}
		\caption{Rufauf und -abbau, sowie Signalisierung eines anderen Codecs mit SIP, Reduktion des Audiostroms mit RTP}
	\label{fig:mitvadundrtpsip}
\end{figure}

%\subsection{SIP Benchmarks}
%\subsection{Mixing}
%-- Verbrauch der CPU Last mit Zunehmender Nutzerzahl beim Full Mesh 
%-- Verbrauch der CPU Last mit Zunehmender Nutzerzahl beim Partial Mesh
%--> Müsste zeigen dass weniger Streams gemischt werden müssen und somit Last eingespart werden %kann. ( Wie messe ich das?)
%MESSUNG: einfach nur die conference bridge messen.

\section{Tests von SIP als Netzwerkschnitstelle}
-- RTT über die zeit bei konstanten benutzern vs. Resultat mit Multicast Sockets oder Skype.